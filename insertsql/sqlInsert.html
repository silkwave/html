<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>INSERT ìƒì„±ê¸°</title>

    <!-- ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì •ì˜ -->
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f5f5f5;
      }

      /* ì»¨í…Œì´ë„ˆ ì¤‘ì•™ ì •ë ¬ ë° ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
      .container {
        max-width: 1200px;
        margin: auto;
      }

      /* ë¼ë²¨ ìŠ¤íƒ€ì¼ */
      label {
        font-weight: bold;
        margin-top: 12px;
        display: block;
      }

      /* ì…ë ¥ í•„ë“œ, í…ìŠ¤íŠ¸ ì˜ì—­, ë²„íŠ¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
      input,
      textarea,
      button {
        width: 100%;
        box-sizing: border-box;
        padding: 10px;
        margin-top: 5px;
        font-size: 16px;
      }

      /* ì…ë ¥ í…ìŠ¤íŠ¸ ì˜ì—­ ìŠ¤íƒ€ì¼ */
      textarea {
        min-height: 300px; /* ğŸ”¥ ë” ì»¤ì§„ ì…ë ¥ì°½ */
        resize: vertical;
      }

      /* ì¶œë ¥ í…ìŠ¤íŠ¸ ì˜ì—­ ìŠ¤íƒ€ì¼ */
      #output {
        min-height: 350px; /* ğŸ”¥ ë” ì»¤ì§„ ì¶œë ¥ì°½ */
        background: #222;
        color: #0f0;
        font-family: Consolas, monospace;
        border-radius: 4px;
        padding: 15px;
      }

      /* ë²„íŠ¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
      button {
        margin-top: 15px;
        font-size: 18px;
        padding: 12px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      }

      /* ê¸°ë³¸ ë²„íŠ¼ (ìƒì„±) ìŠ¤íƒ€ì¼ */
      .btn-primary {
        background: #0066ff;
        color: white;
      }

      /* ë³´ì¡° ë²„íŠ¼ (ë³µì‚¬) ìŠ¤íƒ€ì¼ */
      .btn-secondary {
        background: #555;
        color: white;
      }

      /* ìƒíƒœ ë©”ì‹œì§€ ì˜ì—­ ìŠ¤íƒ€ì¼ */
      #status-message {
        margin-top: 15px;
        padding: 12px;
        border-radius: 4px;
        font-weight: bold;
        display: none;
      }

      /* ì„±ê³µ ìƒíƒœ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
      #status-message.success {
        background-color: #d4edda;
        color: #155724;
        display: block;
      }

      /* ì—ëŸ¬ ìƒíƒœ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
      #status-message.error {
        background-color: #f8d7da;
        color: #721c24;
        display: block;
      }
    </style>
  </head>

  <body>
    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="container">
      <!-- í˜ì´ì§€ ì œëª© -->
      <h2>INSERT ìƒì„±ê¸°</h2>

      <!-- í…Œì´ë¸”ëª… ì…ë ¥ ì„¹ì…˜ -->
      <label>í…Œì´ë¸”ëª…</label>
      <input type="text" id="tableNameInput" value="BOARD" />

      <!-- ë°ì´í„° ì…ë ¥ ì„¹ì…˜ -->
      <label>ë°ì´í„° ì…ë ¥ (Excel ë¶™ì—¬ë„£ê¸° ì§€ì›)</label>
      <textarea id="inputData">
"BOARD_ID" "TITLE" "CONTENTS" "HIT_CNT" "DEL_YN" "CRTR_ID" "CRTE_DT" "UPDT_ID" "UPDT_DT"
1 10 20 N 3 2025-11-04 "" 2025-11-05
    </textarea
      >

      <!-- INSERT ìƒì„± ë²„íŠ¼ -->
      <button class="btn-primary" onclick="generateInsert()">
        INSERT ìƒì„±
      </button>
      <!-- SQL ë³µì‚¬ ë²„íŠ¼ -->
      <button class="btn-secondary" onclick="copySql()">ë³µì‚¬</button>

      <!-- ì¶œë ¥ ê²°ê³¼ ì„¹ì…˜ -->
      <label>ì¶œë ¥ ê²°ê³¼</label>
      <textarea id="output" readonly></textarea>

      <!-- ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ -->
      <div id="status-message"></div>
    </div>

    <script>
      /* ==========================
   ë‚ ì§œ ìë™ ê°ì§€ (ë¦¬íŒ©í† ë§)
   ========================== */
      // ì…ë ¥ëœ ê°’ì´ ë‚ ì§œ í˜•ì‹ì¸ì§€ ê°ì§€í•˜ê³  TO_DATE í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
      function detectDate(value) {
        const dateFormats = [
          {
            regex: /^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/,
            format: "YYYY-MM-DD HH24:MI:SS",
          },
          {
            regex: /^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/,
            format: "YYYY-MM-DD HH24:MI",
          },
          {
            regex: /^\d{2}\/\d{2}\/\d{2} \d{2}:\d{2}:\d{2}$/,
            format: "YY/MM/DD HH24:MI:SS",
          },
          {
            regex: /^\d{2}\/\d{2}\/\d{2} \d{2}:\d{2}$/,
            format: "YY/MM/DD HH24:MI",
          },
          { regex: /^\d{4}-\d{2}-\d{2}$/, format: "YYYY-MM-DD" },
          { regex: /^\d{2}\/\d{2}\/\d{2}$/, format: "YY/MM/DD" },
          // ë‹¤ë¥¸ ë‚ ì§œ í˜•ì‹ì„ ì¶”ê°€í•˜ë ¤ë©´ ì—¬ê¸°ì— ê°ì²´ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.
        ];

        for (const df of dateFormats) {
          if (df.regex.test(value)) {
            return `TO_DATE('${value}', '${df.format}')`;
          }
        }

        // ì¼ì¹˜í•˜ëŠ” ë‚ ì§œ í˜•ì‹ì´ ì—†ìœ¼ë©´ null ë°˜í™˜
        return null;
      }

      /* ==========================
   ê°’ í¬ë§·íŒ… (ë¦¬íŒ©í† ë§)
   ========================== */
      // ì…ë ¥ëœ ê°’ì„ SQL INSERT ë¬¸ì— ë§ê²Œ í¬ë§·íŒ…í•©ë‹ˆë‹¤.
      function formatValue(raw) {
        // ê°’ì´ ì—†ê±°ë‚˜ ë¹ˆ ë¬¸ìì—´ì´ë©´ NULL ë°˜í™˜
        if (!raw || raw.trim() === "") {
          return "NULL";
        }

        let value = raw.trim().replace(/^"|"$/g, ""); // ë”°ì˜´í‘œ ì œê±°

        // ë‚ ì§œ í˜•ì‹ ìš°ì„  ê°ì§€ ë° ë³€í™˜
        const detectedDate = detectDate(value);
        if (detectedDate) {
          return detectedDate;
        }

        // ìˆ«ì ì²˜ë¦¬ ë¡œì§
        const num = value.replace(/,/g, ""); // ì½¤ë§ˆ ì œê±°
        if (!isNaN(num) && num !== "") {
          // 1ìë¦¬ ìˆ«ìë§Œ ìˆ«ì ê·¸ëŒ€ë¡œ ì²˜ë¦¬, ê·¸ ì™¸ëŠ” ë¬¸ìì—´ë¡œ ì²˜ë¦¬
          return num.length === 1 ? num : `'${value.replace(/'/g, "''")}'`;
        }

        // ê·¸ ì™¸ ëª¨ë“  ê°’ì€ ë¬¸ìì—´ë¡œ ì²˜ë¦¬
        return `'${value.replace(/'/g, "''")}'`;
      }

      /* ==========================
   INSERT ìƒì„±
   ========================== */
      // ì…ë ¥ëœ ë°ì´í„°ì™€ í…Œì´ë¸”ëª…ì„ ë°”íƒ•ìœ¼ë¡œ INSERT SQL ë¬¸ì„ ìƒì„±í•©ë‹ˆë‹¤.
      function generateInsert() {
        // í…Œì´ë¸”ëª… ì…ë ¥ í•„ë“œì—ì„œ ê°’ ê°€ì ¸ì˜¤ê¸°
        const tableName = document
          .getElementById("tableNameInput")
          .value.trim();
        // ë°ì´í„° ì…ë ¥ í…ìŠ¤íŠ¸ ì˜ì—­ì—ì„œ ê°’ ê°€ì ¸ì˜¤ê¸°
        const input = document.getElementById("inputData").value.trim();
        // ì¶œë ¥ í…ìŠ¤íŠ¸ ì˜ì—­ ìš”ì†Œ
        const output = document.getElementById("output");
        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ ìš”ì†Œ
        const status = document.getElementById("status-message");

        // í…Œì´ë¸”ëª…ì´ ë¹„ì–´ìˆìœ¼ë©´ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
        if (!tableName) {
          status.className = "error";
          status.textContent = "í…Œì´ë¸”ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.";
          return;
        }

        // ì…ë ¥ ë°ì´í„°ë¥¼ ì¤„ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•˜ê³  ê³µë°± ì œê±° ë° ë¹ˆ ì¤„ í•„í„°ë§
        const lines = input
          .split("\n")
          .map((v) => v.trim())
          .filter((v) => v);

        // ì»¬ëŸ¼ëª…ê³¼ ìµœì†Œ í•œ ì¤„ì˜ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
        if (lines.length < 2) {
          status.className = "error";
          status.textContent = "ì»¬ëŸ¼ê³¼ ìµœì†Œ í•œ ì¤„ì˜ ë°ì´í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤.";
          return;
        }

        // ì²« ë²ˆì§¸ ì¤„ì„ ì»¬ëŸ¼ëª…ìœ¼ë¡œ íŒŒì‹± (ë”°ì˜´í‘œ ì œê±°)
        const columns = (lines[0].match(/"[^"]*"|\S+/g) || []).map((c) =>
          c.replace(/"/g, "")
        );

        // ì²« ë²ˆì§¸ ì¤„ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì¤„ì„ ë°ì´í„° í–‰ìœ¼ë¡œ ì‚¬ìš©
        const rows = lines.slice(1);
        let sqlList = []; // ìƒì„±ëœ SQL ë¬¸ì„ ì €ì¥í•  ë°°ì—´

        // ê° ë°ì´í„° í–‰ì— ëŒ€í•´ INSERT ë¬¸ ìƒì„±
        rows.forEach((row) => {
          // í–‰ ë°ì´í„°ë¥¼ ê³µë°± ë˜ëŠ” ë”°ì˜´í‘œë¡œ ë¬¶ì¸ ë¬¸ìì—´ ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¦¬
          const parts = row.match(/"[^"]*"|\S+/g) || [];
          const padded = [...parts];

          // ì»¬ëŸ¼ ìˆ˜ì— ë§ê²Œ ë°ì´í„° íŒ¨ë”© (ëˆ„ë½ëœ ê°’ì€ ë¹ˆ ë¬¸ìì—´ë¡œ ì±„ì›€)
          while (padded.length < columns.length) padded.push("");

          // ê° ê°’ì„ í¬ë§·íŒ…í•˜ê³  ì½¤ë§ˆë¡œ ì—°ê²°
          const formatted = padded.map((v) => formatValue(v)).join(", ");

          // INSERT ë¬¸ ìƒì„± ë° ë°°ì—´ì— ì¶”ê°€
          sqlList.push(
            `INSERT INTO ${tableName} (${columns.join(
              ", "
            )})\nVALUES (${formatted});`
          );
        });

        // ìƒì„±ëœ SQL ë¬¸ì„ ì¶œë ¥ í…ìŠ¤íŠ¸ ì˜ì—­ì— í‘œì‹œ
        output.value = sqlList.join("\n\n");

        // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
        status.className = "success";
        status.textContent = "INSERT ë¬¸ ìƒì„± ì™„ë£Œ!";
      }

      /* ==========================
   ë³µì‚¬í•˜ê¸°
   ========================== */
      // ìƒì„±ëœ SQL ë¬¸ì„ í´ë¦½ë³´ë“œì— ë³µì‚¬í•©ë‹ˆë‹¤.
      function copySql() {
        // ì¶œë ¥ í…ìŠ¤íŠ¸ ì˜ì—­ì˜ ê°’ ê°€ì ¸ì˜¤ê¸°
        const text = document.getElementById("output").value;

        // ë‚´ìš©ì´ ì—†ìœ¼ë©´ ë³µì‚¬í•˜ì§€ ì•ŠìŒ
        if (!text.trim()) return;

        // í´ë¦½ë³´ë“œì— í…ìŠ¤íŠ¸ ë³µì‚¬
        navigator.clipboard.writeText(text).then(() => {
          const status = document.getElementById("status-message");
          status.className = "success";
          status.textContent = "ë³µì‚¬ ì™„ë£Œ!";
        });
      }
    </script>
  </body>
</html>
