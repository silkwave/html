<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <!-- ë¬¸ì ì¸ì½”ë”©ì„ UTF-8ë¡œ ì„¤ì • -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- ë°˜ì‘í˜• ì›¹ ì„¤ì •ì„ ìœ„í•œ ë·°í¬íŠ¸ ë©”íƒ€ íƒœê·¸ -->
    <title>INSERT ìƒì„±ê¸°</title>
    <!-- ì›¹ í˜ì´ì§€ì˜ ì œëª© ì„¤ì • -->

    <style>
      /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì •ì˜ */
      body {
        font-family: Arial, sans-serif; /* í°íŠ¸ ì„¤ì • */
        margin: 20px; /* ë°”ê¹¥ ì—¬ë°± ì„¤ì • */
        background: #f5f5f5; /* ë°°ê²½ìƒ‰ ì„¤ì • */
      }

      /* ì»¨í…Œì´ë„ˆ ì¤‘ì•™ ì •ë ¬ ë° ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
      .container {
        max-width: 1200px; /* ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
        margin: auto; /* ê°€ìš´ë° ì •ë ¬ */
      }

      /* ë¼ë²¨ ìŠ¤íƒ€ì¼ */
      label {
        font-weight: bold; /* ê¸€ì êµµê¸° */
        margin-top: 12px; /* ìœ„ìª½ ì—¬ë°± */
        display: block; /* ë¸”ë¡ ë ˆë²¨ ìš”ì†Œë¡œ í‘œì‹œ */
      }

      /* ì…ë ¥ í•„ë“œ, í…ìŠ¤íŠ¸ ì˜ì—­, ë²„íŠ¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
      input,
      textarea,
      button {
        width: 100%; /* ë„ˆë¹„ 100% */
        box-sizing: border-box; /* ë°•ìŠ¤ ëª¨ë¸ ì„¤ì • */
        padding: 10px; /* ì•ˆìª½ ì—¬ë°± */
        margin-top: 5px; /* ìœ„ìª½ ì—¬ë°± */
        font-size: 16px; /* í°íŠ¸ í¬ê¸° */
      }

      /* ì…ë ¥ í…ìŠ¤íŠ¸ ì˜ì—­ ìŠ¤íƒ€ì¼ */
      textarea {
        min-height: 300px; /* ìµœì†Œ ë†’ì´ */ /* ğŸ”¥ ë” ì»¤ì§„ ì…ë ¥ì°½ */
        resize: vertical; /* ì„¸ë¡œ í¬ê¸° ì¡°ì ˆ ê°€ëŠ¥ */
      }

      /* ì¶œë ¥ í…ìŠ¤íŠ¸ ì˜ì—­ ìŠ¤íƒ€ì¼ */
      #output {
        min-height: 350px; /* ìµœì†Œ ë†’ì´ */ /* ğŸ”¥ ë” ì»¤ì§„ ì¶œë ¥ì°½ */
        background: #222; /* ë°°ê²½ìƒ‰ */
        color: #0f0; /* ê¸€ììƒ‰ */
        font-family: Consolas, monospace; /* í°íŠ¸ */
        border-radius: 4px; /* í…Œë‘ë¦¬ ë‘¥ê¸€ê²Œ */
        padding: 15px; /* ì•ˆìª½ ì—¬ë°± */
      }

      /* ë²„íŠ¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
      button {
        margin-top: 15px; /* ìœ„ìª½ ì—¬ë°± */
        font-size: 18px; /* í°íŠ¸ í¬ê¸° */
        padding: 12px; /* ì•ˆìª½ ì—¬ë°± */
        border: none; /* í…Œë‘ë¦¬ ì—†ìŒ */
        border-radius: 6px; /* í…Œë‘ë¦¬ ë‘¥ê¸€ê²Œ */
        cursor: pointer; /* ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ ì»¤ì„œ ë³€ê²½ */
      }

      /* ê¸°ë³¸ ë²„íŠ¼ (ìƒì„±) ìŠ¤íƒ€ì¼ */
      .btn-primary {
        background: #0066ff; /* ë°°ê²½ìƒ‰ */
        color: white; /* ê¸€ììƒ‰ */
      }

      /* ë³´ì¡° ë²„íŠ¼ (ë³µì‚¬) ìŠ¤íƒ€ì¼ */
      .btn-secondary {
        background: #555; /* ë°°ê²½ìƒ‰ */
        color: white; /* ê¸€ììƒ‰ */
      }

      /* ìƒíƒœ ë©”ì‹œì§€ ì˜ì—­ ìŠ¤íƒ€ì¼ */
      #status-message {
        margin-top: 15px; /* ìœ„ìª½ ì—¬ë°± */
        padding: 12px; /* ì•ˆìª½ ì—¬ë°± */
        border-radius: 4px; /* í…Œë‘ë¦¬ ë‘¥ê¸€ê²Œ */
        font-weight: bold; /* ê¸€ì êµµê¸° */
        display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
      }

      /* ì„±ê³µ ìƒíƒœ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
      #status-message.success {
        background-color: #d4edda; /* ë°°ê²½ìƒ‰ */
        color: #155724; /* ê¸€ììƒ‰ */
        display: block; /* í‘œì‹œ */
      }

      /* ì—ëŸ¬ ìƒíƒœ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
      #status-message.error {
        background-color: #f8d7da; /* ë°°ê²½ìƒ‰ */
        color: #721c24; /* ê¸€ììƒ‰ */
        display: block; /* í‘œì‹œ */
      }
    </style>
  </head>

  <body>
    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="container">
      <!-- í˜ì´ì§€ ì œëª© -->
      <h2>INSERT ìƒì„±ê¸°</h2>

      <!-- í…Œì´ë¸”ëª… ì…ë ¥ ì„¹ì…˜ -->
      <label>í…Œì´ë¸”ëª…</label>
      <input type="text" id="tableNameInput" value="BOARD" />

      <!-- ë°ì´í„° ì…ë ¥ ì„¹ì…˜ -->
      <label>ë°ì´í„° ì…ë ¥ (Excel ë¶™ì—¬ë„£ê¸° ì§€ì›)</label>
      <textarea id="inputData">
"BOARD_ID" "TITLE" "CONTENTS" "HIT_CNT" "DEL_YN" "CRTR_ID" "CRTE_DT" "UPDT_ID" "UPDT_DT"
1 10 20 N 3 2025-11-04 "" 2025-11-05
    </textarea
      >

      <!-- INSERT ìƒì„± ë²„íŠ¼ -->
      <button class="btn-primary" id="generate-btn">
        INSERT ìƒì„±
      </button>
      <!-- SQL ë³µì‚¬ ë²„íŠ¼ -->
      <button class="btn-secondary" id="copy-btn">ë³µì‚¬</button>

      <!-- ì¶œë ¥ ê²°ê³¼ ì„¹ì…˜ -->
      <label>ì¶œë ¥ ê²°ê³¼</label>
      <textarea id="output" readonly></textarea>

      <!-- ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ -->
      <div id="status-message"></div>
    </div>

    <script>
      (function () {
        // DOM ìš”ì†Œ IDë¥¼ ìƒìˆ˜ë¡œ ê´€ë¦¬í•˜ì—¬ ìœ ì§€ë³´ìˆ˜ì„±ì„ ë†’ì…ë‹ˆë‹¤.
        const UI = {
          TABLE_NAME_INPUT: "tableNameInput",
          INPUT_DATA: "inputData",
          OUTPUT: "output",
          STATUS_MESSAGE: "status-message",
          GENERATE_BTN: "generate-btn",
          COPY_BTN: "copy-btn",
        };

        // ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ê°ì²´
        const state = {
          elements: {},
        };

        /* ==========================
         * ë‚ ì§œ í˜•ì‹ ê°ì§€ ë° ë³€í™˜
         * ========================== */
        function detectDate(value) {
          const dateFormats = [
            { regex: /^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/, format: "YYYY-MM-DD HH24:MI:SS" },
            { regex: /^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/, format: "YYYY-MM-DD HH24:MI" },
            { regex: /^\d{2}\/\d{2}\/\d{2} \d{2}:\d{2}:\d{2}$/, format: "YY/MM/DD HH24:MI:SS" },
            { regex: /^\d{2}\/\d{2}\/\d{2} \d{2}:\d{2}$/, format: "YY/MM/DD HH24:MI" },
            { regex: /^\d{4}-\d{2}-\d{2}$/, format: "YYYY-MM-DD" },
            { regex: /^\d{2}\/\d{2}\/\d{2}$/, format: "YY/MM/DD" },
          ];

          for (const df of dateFormats) {
            if (df.regex.test(value)) {
              return `TO_DATE('${value}', '${df.format}')`;
            }
          }
          return null;
        }

        /* ==========================
         * SQL ê°’ í¬ë§·íŒ…
         * ========================== */
        function formatValue(raw) {
          if (!raw || raw.trim() === "") {
            return "NULL";
          }

          const value = raw.trim().replace(/^"|"$/g, "");
          const detectedDate = detectDate(value);
          if (detectedDate) {
            return detectedDate;
          }

          const num = value.replace(/,/g, "");
          if (!isNaN(num) && num !== "") {
            // ìš”êµ¬ì‚¬í•­: í•œ ìë¦¬ ìˆ«ìë§Œ ìˆ«ì íƒ€ì…ìœ¼ë¡œ, ë‚˜ë¨¸ì§€ëŠ” ë¬¸ìì—´ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
            // ì´ëŠ” ìˆ«ì í˜•ì‹ì˜ IDì™€ ê°™ì€ ê°’ì´ ë¬¸ìì—´ë¡œ ìœ ì§€ë˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.
            return num.length === 1 ? num : `'${value.replace(/'/g, "''")}'`;
          }

          return `'${value.replace(/'/g, "''")}'`;
        }

        /* ==========================
         * í•µì‹¬ SQL ìƒì„± ë¡œì§
         * ========================== */
        function parseAndGenerateSql(tableName, data) {
          if (!tableName) {
            return { error: "í…Œì´ë¸”ëª…ì„ ì…ë ¥í•˜ì„¸ìš”." };
          }

          const lines = data.split("\n").map((v) => v.trim()).filter((v) => v);

          if (lines.length < 2) {
            return { error: "ì»¬ëŸ¼ê³¼ ìµœì†Œ í•œ ì¤„ì˜ ë°ì´í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤." };
          }

          const columns = (lines[0].match(/"[^"]*"|\S+/g) || []).map((c) => c.replace(/"/g, ""));
          const rows = lines.slice(1);

          const sqlList = rows.map((row) => {
            const parts = row.match(/"[^"]*"|\S+/g) || [];
            const padded = [...parts, ...Array(Math.max(0, columns.length - parts.length)).fill("")];
            const formatted = padded.map(formatValue).join(", ");
            return `INSERT INTO ${tableName} (${columns.join(", ")})\nVALUES (${formatted});`;
          });

          return { sql: sqlList.join("\n\n") };
        }

        /* ==========================
         * UI ìƒíƒœ ë° ë©”ì‹œì§€ í‘œì‹œ
         * ========================== */
        function displayStatus(message, isError = false) {
          const { status } = state.elements;
          status.textContent = message;
          status.className = isError ? "error" : "success";
        }

        /* ==========================
         * ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
         * ========================== */
        function handleGenerateClick() {
          const { tableNameInput, inputData, output } = state.elements;
          const { sql, error } = parseAndGenerateSql(tableNameInput.value, inputData.value);

          if (error) {
            displayStatus(error, true);
            output.value = "";
          } else {
            output.value = sql;
            displayStatus("INSERT ë¬¸ ìƒì„± ì™„ë£Œ!");
          }
        }

        function handleCopyClick() {
          const { output } = state.elements;
          if (!output.value.trim()) return;

          navigator.clipboard.writeText(output.value).then(() => {
            displayStatus("ë³µì‚¬ ì™„ë£Œ!");
          });
        }

        /* ==========================
         * ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™”
         * ========================== */
        function init() {
          // ì£¼ìš” DOM ìš”ì†Œë¥¼ í•œ ë²ˆë§Œ ì¡°íšŒí•˜ì—¬ ìƒíƒœì— ì €ì¥í•©ë‹ˆë‹¤.
          state.elements.tableNameInput = document.getElementById(UI.TABLE_NAME_INPUT);
          state.elements.inputData = document.getElementById(UI.INPUT_DATA);
          state.elements.output = document.getElementById(UI.OUTPUT);
          state.elements.status = document.getElementById(UI.STATUS_MESSAGE);
          state.elements.generateBtn = document.getElementById(UI.GENERATE_BTN);
          state.elements.copyBtn = document.getElementById(UI.COPY_BTN);

          // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
          state.elements.generateBtn.addEventListener("click", handleGenerateClick);
          state.elements.copyBtn.addEventListener("click", handleCopyClick);
        }

        // DOMì´ ì™„ì „íˆ ë¡œë“œëœ í›„ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
        document.addEventListener("DOMContentLoaded", init);
      })();
    </script>
  </body>
</html>
