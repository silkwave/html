<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>Base64 MS949 ë””ì½”ë”©</title>
  </head>
  <body>
    <h1>Base64 MS949 ë””ì½”ë”©</h1>

    <!-- git config --list --show-origin -->

    <label>Base64 ë¬¸ìì—´ ì…ë ¥ (MS949 ì¸ì½”ë”© ê¸°ë°˜):</label><br />
    <textarea id="base64Input" rows="6" cols="60">vsiz58fPvLy/5A==</textarea
    ><br />

    <label>íŒŒì¼ ì—…ë¡œë“œ (.c íŒŒì¼ â†’ Base64 ë³€í™˜):</label><br />
    <input type="file" id="fileInput" accept=".c" /><br /><br />

    <button id="decodeBtn">ë””ì½”ë”©í•˜ê¸°</button>

    <div id="message" style="margin-top: 10px; font-weight: bold"></div>

    <h3>ğŸ” Base64 ë””ì½”ë”© ë¯¸ë¦¬ë³´ê¸°</h3>
    <pre
      id="preview"
      style="
        border: 1px solid #ccc;
        padding: 10px;
        white-space: pre-wrap;
        min-height: 150px;
      "
    >
ë””ì½”ë”© ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre
    >

    <script>
      const $ = (id) => document.getElementById(id);
      const base64Input = $("base64Input"),
        message = $("message"),
        preview = $("preview"),
        fileInput = $("fileInput"),
        decodeBtn = $("decodeBtn");

      const showMsg = (t, e = false) => {
        message.textContent = t;
        message.style.color = e ? "red" : "green";
      };

      const base64ToUint8 = (b64) => {
        try {
          const b = atob(b64);
          return Uint8Array.from(b, (c) => c.charCodeAt(0));
        } catch {
          return null;
        }
      };

      const decodeBytes = (bytes) => {
        try {
          return {
            utf8: new TextDecoder("utf-8").decode(bytes),
            ms949: new TextDecoder("windows-949").decode(bytes),
          };
        } catch {
          return { utf8: "[ë””ì½”ë”© ì‹¤íŒ¨]", ms949: "[ë””ì½”ë”© ì‹¤íŒ¨]" };
        }
      };

      decodeBtn.onclick = () => {
        showMsg("");
        preview.textContent = "";
        const b64 = base64Input.value.trim();
        if (!b64) return showMsg("Base64 ë¬¸ìì—´ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.", true);
        const bytes = base64ToUint8(b64);
        if (!bytes)
          return showMsg(
            "Base64 ë””ì½”ë”© ì‹¤íŒ¨. ìœ íš¨í•œ ë¬¸ìì—´ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.",
            true
          );
        const d = decodeBytes(bytes);
        preview.textContent = `[UTF-8 í•´ì„]\n${d.utf8}\n\n[MS949 í•´ì„]\n${d.ms949}`;
        showMsg("ë””ì½”ë”©ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
      };

      fileInput.onchange = () => {
        const f = fileInput.files[0];
        if (!f) return;
        const r = new FileReader();
        r.onload = (e) => {
          const bin = new Uint8Array(e.target.result);
          base64Input.value = btoa(String.fromCharCode(...bin));
          showMsg("íŒŒì¼ì´ Base64ë¡œ ë³€í™˜ë˜ì–´ ì…ë ¥ë€ì— ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤.");
        };
        r.readAsArrayBuffer(f);
      };
    </script>
  </body>
</html>
